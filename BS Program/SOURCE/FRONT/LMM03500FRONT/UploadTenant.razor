@inherits R_Page
@using LMM03500COMMON.DTOs.LMM03501
@attribute [R_Page(Title = "Upload")]


<R_StackLayout Style="width: 1000px">
    <R_StackLayout>
        <R_StackLayout Row>
            <R_ItemLayout col="2">
                <R_Label>@_localizer["_Property"]</R_Label>
            </R_ItemLayout>
            <R_ItemLayout col="2">
                <R_TextBox R_ConductorGridSource="_conGridUploadTenantRef"
                           Enabled="false"
                           @bind-Value="loUploadTenantViewModel.loParameter.PropertyData.CPROPERTY_ID">
                </R_TextBox>
            </R_ItemLayout>
            <R_ItemLayout col="8">
                <R_TextBox R_ConductorGridSource="_conGridUploadTenantRef"
                           Enabled="false"
                           @bind-Value="loUploadTenantViewModel.loParameter.PropertyData.CPROPERTY_NAME">
                </R_TextBox>
            </R_ItemLayout>
        </R_StackLayout>
        <R_StackLayout Row>
            <R_InputFile OnChange="OnChangeInputFile" Accepts="@accepts"></R_InputFile>
        </R_StackLayout>
    </R_StackLayout>
    <R_StackLayout>
        <R_StackLayout Row>
            <R_ItemLayout col="12">
                <R_Grid @ref="@_gridUploadTenantRef"
                        DataSource="@loUploadTenantViewModel.loUploadTenantDisplayList"
                        Pageable="true"
                        R_ConductorGridSource="@_conGridUploadTenantRef"
                        R_GridType="@R_eGridType.Batch"
                        AllowAddNewRow="false"
                        AllowEditRow="false"
                        AllowDeleteRow="false"
                        Height="250px"
                        R_ServiceGetListRecord="@Grid_R_ServiceGetListRecord">
                    <R_GridColumns>
                        <R_GridTextColumn FieldName=@nameof(UploadTenantDTO.NO) HeaderText="@_localizer["_No"]" Enabled="false" Width="100px"></R_GridTextColumn>
                        <R_GridTextColumn FieldName=@nameof(UploadTenantDTO.TenantId) HeaderText="@_localizer["_TenantId"]" Enabled="false" Width="150px"></R_GridTextColumn>
                        <R_GridTextColumn FieldName=@nameof(UploadTenantDTO.TenantName) HeaderText="@_localizer["_TenantName"]" Enabled="false" Width="200px"></R_GridTextColumn>
                        <R_GridTextColumn FieldName=@nameof(UploadTenantDTO.Address) HeaderText="@_localizer["_Address"]" Enabled="false" Width="200px"></R_GridTextColumn>
                        <R_GridTextColumn FieldName=@nameof(UploadTenantDTO.City) HeaderText="@_localizer["_City"]" Enabled="false" Width="200px"></R_GridTextColumn>
                        <R_GridTextColumn FieldName=@nameof(UploadTenantDTO.Province) HeaderText="@_localizer["_Province"]" Enabled="false" Width="200px"></R_GridTextColumn>
                        <R_GridTextColumn FieldName=@nameof(UploadTenantDTO.Country) HeaderText="@_localizer["_Country"]" Enabled="false" Width="200px"></R_GridTextColumn>
                        <R_GridTextColumn FieldName=@nameof(UploadTenantDTO.ZipCode) HeaderText="@_localizer["_ZipCode"]" Enabled="false" Width="200px"></R_GridTextColumn>
                        <R_GridTextColumn FieldName=@nameof(UploadTenantDTO.Email) HeaderText="@_localizer["_Email"]" Enabled="false" Width="200px"></R_GridTextColumn>
                        <R_GridTextColumn FieldName=@nameof(UploadTenantDTO.PhoneNo1) HeaderText="@_localizer["_PhoneNo1"]" Enabled="false" Width="150px"></R_GridTextColumn>
                        <R_GridTextColumn FieldName=@nameof(UploadTenantDTO.PhoneNo2) HeaderText="@_localizer["_PhoneNo2"]" Enabled="false" Width="150px"></R_GridTextColumn>
                        <R_GridTextColumn FieldName=@nameof(UploadTenantDTO.TenantGroup) HeaderText="@_localizer["_TenantGroup"]" Enabled="false" Width="150px"></R_GridTextColumn>
                        <R_GridTextColumn FieldName=@nameof(UploadTenantDTO.TenantCategory) HeaderText="@_localizer["_TenantCategory"]" Enabled="false" Width="150px"></R_GridTextColumn>
                        <R_GridTextColumn FieldName=@nameof(UploadTenantDTO.TenantType) HeaderText="@_localizer["_TenantType"]" Enabled="false" Width="150px"></R_GridTextColumn>
                        <R_GridTextColumn FieldName=@nameof(UploadTenantDTO.JournalGroup) HeaderText="@_localizer["_JournalGroup"]" Enabled="false" Width="150px"></R_GridTextColumn>
                        <R_GridTextColumn FieldName=@nameof(UploadTenantDTO.PaymentTerm) HeaderText="@_localizer["_PaymentTerm"]" Enabled="false" Width="150px"></R_GridTextColumn>
                        <R_GridTextColumn FieldName=@nameof(UploadTenantDTO.Currency) HeaderText="@_localizer["_Currency"]" Enabled="false" Width="150px"></R_GridTextColumn>
                        <R_GridTextColumn FieldName=@nameof(UploadTenantDTO.Salesman) HeaderText="@_localizer["_Salesman"]" Enabled="false" Width="150px"></R_GridTextColumn>
                        <R_GridTextColumn FieldName=@nameof(UploadTenantDTO.LineOfBusiness) HeaderText="@_localizer["_LineofBusiness"]" Enabled="false" Width="150px"></R_GridTextColumn>
                        <R_GridTextColumn FieldName=@nameof(UploadTenantDTO.FamilyCard) HeaderText="@_localizer["_FamilyCard"]" Enabled="false" Width="150px"></R_GridTextColumn>
                        <R_GridTextColumn FieldName=@nameof(UploadTenantDTO.Valid) HeaderText="@_localizer["_Valid"]" Enabled="false" Width="100px"></R_GridTextColumn>
                        <R_GridTextColumn FieldName=@nameof(UploadTenantDTO.Notes) HeaderText="@_localizer["_Notes"]" Enabled="false" Width="350px"></R_GridTextColumn>
                    </R_GridColumns>
                </R_Grid>
            </R_ItemLayout>
        </R_StackLayout>
        <R_StackLayout Row>
            <R_ItemLayout col="12">
                <R_ProgressBar Label="@loUploadTenantViewModel.Message" MaxValue="100" Value="@loUploadTenantViewModel.Percentage"></R_ProgressBar>
            </R_ItemLayout>
        </R_StackLayout>
        <R_StackLayout Row>
            <R_ItemLayout col="8">
                <R_StackLayout Row>
                    <R_ItemLayout col="3">
                        <R_Label>@_localizer["_TotalRows"]</R_Label>
                    </R_ItemLayout>
                    <R_ItemLayout col="2">
                        <R_NumericTextBox @bind-Value="@loUploadTenantViewModel.SumList"
                                    Arrows="false"
                                   Enabled="false">
                        </R_NumericTextBox>
                    </R_ItemLayout>
                    <R_ItemLayout col="1">
                        <R_Label>@_localizer["_Valid"]</R_Label>
                    </R_ItemLayout>
                    <R_ItemLayout col="2" Class="bg-success">
                        <R_NumericTextBox @bind-Value="@loUploadTenantViewModel.SumValid"
                                          Arrows="false"
                                          Enabled="false">
                        </R_NumericTextBox>
                    </R_ItemLayout>
                    <R_ItemLayout col="1">
                        <R_Label>@_localizer["_Invalid"]</R_Label>
                    </R_ItemLayout>
                    <R_ItemLayout col="2" Class="badge bg-danger">
                        <R_NumericTextBox @bind-Value="@loUploadTenantViewModel.SumInvalid"
                                          Arrows="false"
                                          Enabled="false">
                        </R_NumericTextBox>
                    </R_ItemLayout>
                </R_StackLayout>
            </R_ItemLayout>
            <R_ItemLayout col="4" hidden="@loUploadTenantViewModel.VisibleError">
                <R_StackLayout Row Class="justify-content-end">
                    <R_ItemLayout>
                        <R_Button OnClick="OnCancel">
                            @_localizer["_Cancel"]
                        </R_Button>
                        <R_Button OnClick="OnProcess" Enabled="@IsProcessEnabled">
                            @_localizer["_Process"]
                        </R_Button>
                    </R_ItemLayout>
                </R_StackLayout>
            </R_ItemLayout>
                <R_ItemLayout col="4" hidden="@(!loUploadTenantViewModel.VisibleError)">
                <R_StackLayout Row Class="justify-content-end">
                    <R_ItemLayout>
                        <R_Button OnClick="OnCancel">
                            @_localizer["_Cancel"]
                        </R_Button>
                        <R_Button OnClick="@OnSaveToExcel">
                            @_localizer["_SaveToExcel"]
                        </R_Button>
                    </R_ItemLayout>
                </R_StackLayout>
            </R_ItemLayout>
        </R_StackLayout>
    </R_StackLayout>
</R_StackLayout>

<R_ConductorGrid @ref="@_conGridUploadTenantRef"
                 R_ViewModel="@loUploadTenantViewModel"
                 R_IsHeader
                 R_BeforeSaveBatch="@R_BeforeSaveBatch"
                 R_ServiceSaveBatch="@R_ServiceSaveBatch"
                 R_AfterSaveBatch="@R_AfterSaveBatch">
</R_ConductorGrid>